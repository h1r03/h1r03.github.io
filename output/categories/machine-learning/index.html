<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Posts about Machine Learning | Step-by-step Data Science</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#4285F4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href=".">
<link rel="icon" href="images/LogoMakr_2dGBSO.png" sizes="16x16">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-134273341-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134273341-1');
</script><link rel="alternate" type="application/rss+xml" title="RSS for category Machine Learning" hreflang="en" href="../machine-learning.xml">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../">

                <span id="blog-title">Step-by-step Data Science</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../coding">Coding Problems</a>
                </li>
<li>
<a href="../machine-learning">Machine Learning</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">All <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../posts/">All Post</a>
                    </li>
<li>
<a href="../">Categories and Tags</a>
                    </li>
<li>
<a href="../../archive.html">History</a>
            </li>
</ul>
</li>
<li>
<a href="../../rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    <header><h1>Posts about Machine Learning</h1>
        <div class="metadata">
            
                <p class="feedlink">
                        
            <a href="../machine-learning.xml" hreflang="en" type="application/rss+xml">RSS feed</a>

                </p>

            

        </div>
    </header><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/Logistic-regression/" class="u-url">Logistic Regression</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/Logistic-regression/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-05T22:25:33-07:00" itemprop="datePublished" title="Jun 5, 2019, 10:25:33 PM">Jun 5, 2019, 10:25:33 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/Logistic-regression/#disqus_thread" data-disqus-identifier="cache/posts/logistic-regression.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/Logistic-regression/#Goal">¶</a>
</h2>
<p>This post aims to introduce <strong>logistic regression</strong> using dummy data.</p>
<p><img src="https://user-images.githubusercontent.com/8764683/59031633-30b72f80-889f-11e9-8eeb-bb9e1e10c237.png" alt="image"></p>
<p><strong>Reference</strong></p>
<ul>
<li>
<p><a href="https://towardsdatascience.com/building-a-logistic-regression-in-python-301d27367c24">Towards Data Science - Logistic Regression in Python</a></p>
</li>
<li>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">scikit-learn - Logistic Regression</a></p>
</li>
<li><a href="https://scikit-learn.org/stable/modules/cross_validation.html">scikit-learn documentation - cross validation</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="more"><a href="../../posts/Logistic-regression/">Read more… </a></p>
</div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/precision/" class="u-url">Precision</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/precision/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-04T20:05:41-07:00" itemprop="datePublished" title="Jun 4, 2019, 8:05:41 PM">Jun 4, 2019, 8:05:41 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/precision/#disqus_thread" data-disqus-identifier="cache/posts/precision.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/precision/#Goal">¶</a>
</h2>
<p>This post aims to introduce one of the model evaluation metrics, called <strong>Precision score</strong>. Precision score is used to measure the prediction ratio of how many of predictions were correct out of the total number of the predictions. As the precision score is higher, the prediction would be high likely true whenever such prediction is made.</p>
<p>Precision score is defined as the following equations:</p>
$$
{\displaystyle {\text{Precision}}={\frac {True\;Positive}{True\;Positive + False\;Positive}}\,} = \frac {True \;Positive}{total\;\#\,of\;samples\;predicated\;as\;True}
$$<p><strong>Reference</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Precision">Wikipedia - Precision score</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html">scikit learn - Precision score</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/precision/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">precision_score</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-prediction-and-ground-truth">Create a prediction and ground truth<a class="anchor-link" href="../../posts/precision/#Create-a-prediction-and-ground-truth">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">])</span>
<span class="n">df_prediction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>prediction</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>1</td>
    </tr>
<tr>
<th>2</th>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>1</td>
    </tr>
<tr>
<th>4</th>
      <td>1</td>
    </tr>
<tr>
<th>5</th>
      <td>1</td>
    </tr>
<tr>
<th>6</th>
      <td>1</td>
    </tr>
<tr>
<th>7</th>
      <td>1</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_groundtruth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'gt'</span><span class="p">])</span>
<span class="n">df_groundtruth</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>gt</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>0</td>
    </tr>
<tr>
<th>2</th>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>0</td>
    </tr>
<tr>
<th>4</th>
      <td>1</td>
    </tr>
<tr>
<th>5</th>
      <td>1</td>
    </tr>
<tr>
<th>6</th>
      <td>1</td>
    </tr>
<tr>
<th>7</th>
      <td>1</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compute-F1-Score">Compute F1 Score<a class="anchor-link" href="../../posts/precision/#Compute-F1-Score">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">df_groundtruth</span><span class="p">,</span> 
        <span class="n">y_pred</span><span class="o">=</span><span class="n">df_prediction</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'binary'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6666666666666666</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="double-check-by-precision-and-recall">double check by precision and recall<a class="anchor-link" href="../../posts/precision/#double-check-by-precision-and-recall">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TP</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_prediction</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_prediction</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="s1">'prediction'</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_groundtruth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_prediction</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="s1">'gt'</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">TP</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FP</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_prediction</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_prediction</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="s1">'prediction'</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df_groundtruth</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_prediction</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="s1">'gt'</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">FP</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">FP</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.6666666666666666</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/variance-thresholding-for-feature-selection/" class="u-url">Variance Thresholding For Feature Selection</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/variance-thresholding-for-feature-selection/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-03T15:16:12-07:00" itemprop="datePublished" title="Jun 3, 2019, 3:16:12 PM">Jun 3, 2019, 3:16:12 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/variance-thresholding-for-feature-selection/#disqus_thread" data-disqus-identifier="cache/posts/variance-thresholding-for-feature-selection.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/variance-thresholding-for-feature-selection/#Goal">¶</a>
</h2>
<p>This post aims to introduce how to conduct feature selection by <strong>variance thresholding</strong></p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/feature_selection.html">scikit-learn - Feature Selection</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/variance-thresholding-for-feature-selection/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">VarianceThreshold</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_boston</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-Boston-housing-data">Load Boston housing data<a class="anchor-link" href="../../posts/variance-thresholding-for-feature-selection/#Load-Boston-housing-data">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">boston</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>
<span class="n">df_boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df_boston</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0.0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1.0</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
    </tr>
<tr>
<th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
    </tr>
<tr>
<th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
    </tr>
<tr>
<th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
    </tr>
<tr>
<th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Add-low-variance-columns">Add low variance columns<a class="anchor-link" href="../../posts/variance-thresholding-for-feature-selection/#Add-low-variance-columns">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.08309365785384086</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_boston</span><span class="p">[</span><span class="s1">'low_variance'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">df_boston</span><span class="p">[</span><span class="s1">'low_variance2'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">df_boston</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>low_variance</th>
      <th>low_variance2</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0.0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1.0</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>1</td>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>1</td>
      <td>1</td>
    </tr>
<tr>
<th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>1</td>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>1</td>
      <td>1</td>
    </tr>
<tr>
<th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>1</td>
      <td>1</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Variance-Thresholding">Variance Thresholding<a class="anchor-link" href="../../posts/variance-thresholding-for-feature-selection/#Variance-Thresholding">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">variance_threshold</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">variance_threshold</span><span class="p">)</span>
<span class="n">selection</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_boston</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>VarianceThreshold(threshold=0.1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">variances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'bar'</span><span class="p">,</span> <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">variance_threshold</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">'dotted'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_boston_selected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_boston</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selection</span><span class="o">.</span><span class="n">get_support</span><span class="p">()])</span>
<span class="n">df_boston_selected</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[52]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>low_variance2</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1.0</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>0.0</td>
    </tr>
<tr>
<th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>1.0</td>
    </tr>
<tr>
<th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>0.0</td>
    </tr>
<tr>
<th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>1.0</td>
    </tr>
<tr>
<th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>1.0</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/f1-score/" class="u-url">F1 Score</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/f1-score/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-02T00:30:51-07:00" itemprop="datePublished" title="Jun 2, 2019, 12:30:51 AM">Jun 2, 2019, 12:30:51 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/f1-score/#disqus_thread" data-disqus-identifier="cache/posts/f1-score.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/f1-score/#Goal">¶</a>
</h2>
<p>This post aims to introduce one of the model evaluation metrics, called <strong>F1 score</strong>. F1 score is used to measure the overall model performance. As F1 score is higher, the model performance would be better in general.</p>
<p>F1 score is defined as the following equations:</p>
$$
F_1 = 2 \cdot \frac{precision \cdot recall}{precision + recall}
$$<p><strong>Reference</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/F1_score">Wikipedia - F1 score</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html">scikit learn - F1 score</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/f1-score/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-prediction-and-ground-truth">Create a prediction and ground truth<a class="anchor-link" href="../../posts/f1-score/#Create-a-prediction-and-ground-truth">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'prediction'</span><span class="p">])</span>
<span class="n">df_prediction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>prediction</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>1</td>
    </tr>
<tr>
<th>2</th>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>1</td>
    </tr>
<tr>
<th>4</th>
      <td>0</td>
    </tr>
<tr>
<th>5</th>
      <td>1</td>
    </tr>
<tr>
<th>6</th>
      <td>0</td>
    </tr>
<tr>
<th>7</th>
      <td>1</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_groundtruth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'gt'</span><span class="p">])</span>
<span class="n">df_groundtruth</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>gt</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0</td>
    </tr>
<tr>
<th>1</th>
      <td>0</td>
    </tr>
<tr>
<th>2</th>
      <td>0</td>
    </tr>
<tr>
<th>3</th>
      <td>0</td>
    </tr>
<tr>
<th>4</th>
      <td>1</td>
    </tr>
<tr>
<th>5</th>
      <td>1</td>
    </tr>
<tr>
<th>6</th>
      <td>1</td>
    </tr>
<tr>
<th>7</th>
      <td>1</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compute-F1-Score">Compute F1 Score<a class="anchor-link" href="../../posts/f1-score/#Compute-F1-Score">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">df_groundtruth</span><span class="p">,</span> 
        <span class="n">y_pred</span><span class="o">=</span><span class="n">df_prediction</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="double-check-by-precision-and-recall">double check by precision and recall<a class="anchor-link" href="../../posts/f1-score/#double-check-by-precision-and-recall">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">df_groundtruth</span><span class="p">,</span> 
        <span class="n">y_pred</span><span class="o">=</span><span class="n">df_prediction</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">df_groundtruth</span><span class="p">,</span> 
        <span class="n">y_pred</span><span class="o">=</span><span class="n">df_prediction</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/select-date-and-time-ranges/" class="u-url">Select Date And Time Ranges</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/select-date-and-time-ranges/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-31T23:10:46-07:00" itemprop="datePublished" title="May 31, 2019, 11:10:46 PM">May 31, 2019, 11:10:46 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/select-date-and-time-ranges/#disqus_thread" data-disqus-identifier="cache/posts/select-date-and-time-ranges.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/select-date-and-time-ranges/#Goal">¶</a>
</h2>
<p>This post aims to introduce how to select a subset of the <code>pandas</code> dataframe by selecting a date range.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/select-date-and-time-ranges/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-dataframe">Create a dataframe<a class="anchor-link" href="../../posts/select-date-and-time-ranges/#Create-a-dataframe">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">date_ranges</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">'20190101'</span><span class="p">,</span> <span class="s1">'20191231'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'d'</span><span class="p">)</span>
<span class="n">df_rand</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span> <span class="n">date_ranges</span><span class="p">,</span> 
                       <span class="s1">'value'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">date_ranges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])})</span>
<span class="n">df_rand</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>date</th>
      <th>value</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>2019-01-01</td>
      <td>0.332090</td>
    </tr>
<tr>
<th>1</th>
      <td>2019-01-02</td>
      <td>0.690167</td>
    </tr>
<tr>
<th>2</th>
      <td>2019-01-03</td>
      <td>0.237744</td>
    </tr>
<tr>
<th>3</th>
      <td>2019-01-04</td>
      <td>0.060678</td>
    </tr>
<tr>
<th>4</th>
      <td>2019-01-05</td>
      <td>0.572691</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Select-a-range-using-.between">Select a range using <code>.between</code><a class="anchor-link" href="../../posts/select-date-and-time-ranges/#Select-a-range-using-.between">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_rand</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_rand</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">'20190201'</span><span class="p">,</span> <span class="s1">'20190211'</span><span class="p">),:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>date</th>
      <th>value</th>
    </tr></thead>
<tbody>
<tr>
<th>31</th>
      <td>2019-02-01</td>
      <td>0.449901</td>
    </tr>
<tr>
<th>32</th>
      <td>2019-02-02</td>
      <td>0.803429</td>
    </tr>
<tr>
<th>33</th>
      <td>2019-02-03</td>
      <td>0.299074</td>
    </tr>
<tr>
<th>34</th>
      <td>2019-02-04</td>
      <td>0.630970</td>
    </tr>
<tr>
<th>35</th>
      <td>2019-02-05</td>
      <td>0.294973</td>
    </tr>
<tr>
<th>36</th>
      <td>2019-02-06</td>
      <td>0.510857</td>
    </tr>
<tr>
<th>37</th>
      <td>2019-02-07</td>
      <td>0.345567</td>
    </tr>
<tr>
<th>38</th>
      <td>2019-02-08</td>
      <td>0.877957</td>
    </tr>
<tr>
<th>39</th>
      <td>2019-02-09</td>
      <td>0.990186</td>
    </tr>
<tr>
<th>40</th>
      <td>2019-02-10</td>
      <td>0.000186</td>
    </tr>
<tr>
<th>41</th>
      <td>2019-02-11</td>
      <td>0.378379</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/convert-strings-to-dates/" class="u-url">Convert Strings To Dates</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/convert-strings-to-dates/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-31T01:12:43-07:00" itemprop="datePublished" title="May 31, 2019, 1:12:43 AM">May 31, 2019, 1:12:43 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/convert-strings-to-dates/#disqus_thread" data-disqus-identifier="cache/posts/convert-strings-to-dates.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/convert-strings-to-dates/#Goal">¶</a>
</h2>
<p>This post aims to introduce how to convert strings to dates using <code>pandas</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/convert-strings-to-dates/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Date-in-string">Date in string<a class="anchor-link" href="../../posts/convert-strings-to-dates/#Date-in-string">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:[</span><span class="s1">'20190101'</span><span class="p">,</span> <span class="s1">'20190102'</span><span class="p">,</span> <span class="s1">'20190105'</span><span class="p">],</span> 
                       <span class="s1">'temperature'</span><span class="p">:</span> <span class="p">[</span><span class="mf">23.5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">25</span><span class="p">]})</span>
<span class="n">df_date</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>date</th>
      <th>temperature</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>20190101</td>
      <td>23.5</td>
    </tr>
<tr>
<th>1</th>
      <td>20190102</td>
      <td>32.0</td>
    </tr>
<tr>
<th>2</th>
      <td>20190105</td>
      <td>25.0</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convert-strings-to-date-format">Convert strings to date format<a class="anchor-link" href="../../posts/convert-strings-to-dates/#Convert-strings-to-date-format">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_date</span><span class="p">[</span><span class="s1">'date'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0   2019-01-01
1   2019-01-02
2   2019-01-05
Name: date, dtype: datetime64[ns]</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/tokenize-text/" class="u-url">Tokenize Text</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/tokenize-text/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-30T05:40:08-07:00" itemprop="datePublished" title="May 30, 2019, 5:40:08 AM">May 30, 2019, 5:40:08 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/tokenize-text/#disqus_thread" data-disqus-identifier="cache/posts/tokenize-text.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/tokenize-text/#Goal">¶</a>
</h2>
<p>This post aims to introduce how to tokenize text using <code>nltk</code>.</p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://www.geeksforgeeks.org/tokenize-text-using-nltk-python/">GeeksforGeeks - Tokenize text using NLTK in python</a></li>
<li><a href="https://text-processing.com/demo/tokenize/">Text-processing.com - Tokenize Demo</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/tokenize-text/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="k">import</span> <span class="n">sent_tokenize</span><span class="p">,</span> <span class="n">word_tokenize</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-sentences">Create a sentences<a class="anchor-link" href="../../posts/tokenize-text/#Create-a-sentences">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">paragraph</span> <span class="o">=</span> <span class="s2">"Python is an interpreted, high-level, general-purpose programming language. Created by Guido van Rossum and first released in 1991, Python's design philosophy emphasizes code readability with its notable use of significant whitespace. Its language constructs and object-oriented approach aims to help programmers write clear, logical code for small and large-scale projects"</span>
<span class="n">paragraph</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>"Python is an interpreted, high-level, general-purpose programming language. Created by Guido van Rossum and first released in 1991, Python's design philosophy emphasizes code readability with its notable use of significant whitespace. Its language constructs and object-oriented approach aims to help programmers write clear, logical code for small and large-scale projects"</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tokenize-a-paragraph-into-sentences">Tokenize a paragraph into sentences<a class="anchor-link" href="../../posts/tokenize-text/#Tokenize-a-paragraph-into-sentences">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">paragraph</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>['Python is an interpreted, high-level, general-purpose programming language.',
 "Created by Guido van Rossum and first released in 1991, Python's design philosophy emphasizes code readability with its notable use of significant whitespace.",
 'Its language constructs and object-oriented approach aims to help programmers write clear, logical code for small and large-scale projects']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tokenize-a-paragraph-into-words">Tokenize a paragraph into words<a class="anchor-link" href="../../posts/tokenize-text/#Tokenize-a-paragraph-into-words">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">paragraph</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>['Python',
 'is',
 'an',
 'interpreted',
 ',',
 'high-level',
 ',',
 'general-purpose',
 'programming',
 'language',
 '.',
 'Created',
 'by',
 'Guido',
 'van',
 'Rossum',
 'and',
 'first',
 'released',
 'in',
 '1991',
 ',',
 'Python',
 "'s",
 'design',
 'philosophy',
 'emphasizes',
 'code',
 'readability',
 'with',
 'its',
 'notable',
 'use',
 'of',
 'significant',
 'whitespace',
 '.',
 'Its',
 'language',
 'constructs',
 'and',
 'object-oriented',
 'approach',
 'aims',
 'to',
 'help',
 'programmers',
 'write',
 'clear',
 ',',
 'logical',
 'code',
 'for',
 'small',
 'and',
 'large-scale',
 'projects']</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/bag-of-words/" class="u-url">Bag Of Words</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/bag-of-words/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-27T23:40:24-07:00" itemprop="datePublished" title="May 27, 2019, 11:40:24 PM">May 27, 2019, 11:40:24 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/bag-of-words/#disqus_thread" data-disqus-identifier="cache/posts/bag-of-words.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/bag-of-words/#Goal">¶</a>
</h2>
<p>This post aims to introduce <strong>Bag of words</strong> which can be used as features for each document or images.</p>
<p>Simply, <strong>bag of words</strong> are frequency of word with associated index for each word.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libaries">Libaries<a class="anchor-link" href="../../posts/bag-of-words/#Libaries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfTransformer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-document">Create a document<a class="anchor-link" href="../../posts/bag-of-words/#Create-a-document">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'this is a sample.'</span><span class="p">,</span> 
            <span class="s1">'this is another example. "this" also appears in the second example.'</span><span class="p">]</span>

<span class="n">documents</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>['this is a sample.',
 'this is another example. "this" also appears in the second example.']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-count-vector">Create a count vector<a class="anchor-link" href="../../posts/bag-of-words/#Create-a-count-vector">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">word_counts</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>

<span class="n">df_word_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_counts</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">count_vect</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">df_word_counts</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>also</th>
      <th>another</th>
      <th>appears</th>
      <th>example</th>
      <th>in</th>
      <th>is</th>
      <th>sample</th>
      <th>second</th>
      <th>the</th>
      <th>this</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
<tr>
<th>1</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-frequency-vector">Create a frequency vector<a class="anchor-link" href="../../posts/bag-of-words/#Create-a-frequency-vector">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf_transformer</span> <span class="o">=</span> <span class="n">TfidfTransformer</span><span class="p">(</span><span class="n">use_idf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_word_counts</span><span class="p">)</span>
<span class="n">word_freq</span> <span class="o">=</span> <span class="n">tf_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_word_counts</span><span class="p">)</span>
<span class="n">df_word_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_freq</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">count_vect</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">df_word_freq</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>also</th>
      <th>another</th>
      <th>appears</th>
      <th>example</th>
      <th>in</th>
      <th>is</th>
      <th>sample</th>
      <th>second</th>
      <th>the</th>
      <th>this</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.577350</td>
      <td>0.57735</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.577350</td>
    </tr>
<tr>
<th>1</th>
      <td>0.258199</td>
      <td>0.258199</td>
      <td>0.258199</td>
      <td>0.516398</td>
      <td>0.258199</td>
      <td>0.258199</td>
      <td>0.00000</td>
      <td>0.258199</td>
      <td>0.258199</td>
      <td>0.516398</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/term-frequency-inverse-document-frequency/" class="u-url">Term Frequency Inverse Document Frequency</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/term-frequency-inverse-document-frequency/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-26T22:15:17-07:00" itemprop="datePublished" title="May 26, 2019, 10:15:17 PM">May 26, 2019, 10:15:17 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/term-frequency-inverse-document-frequency/#disqus_thread" data-disqus-identifier="cache/posts/term-frequency-inverse-document-frequency.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/term-frequency-inverse-document-frequency/#Goal">¶</a>
</h2>
<p>This post aims to introduce <strong>term frequency-inverse document frequency</strong> as known as <strong>TF-IDF</strong>, which indicates the importance of the words in a document considering the frequency of them across multiple documents and used for feature creation.</p>
<p><strong>Term Frequency (TF)</strong></p>
<p>Term Frequency can be computed as the number of occurrence of the word $n_{word}$ divided by the total number of words in a document $N_{word}$.</p>
\begin{equation*}
TF = \frac{n_{word}}{N_{word}}
\end{equation*}<p><strong>Document Frequency (DF)</strong></p>
<p>Document Frequency can be computed as the number of documents containing the word $n_{doc}$ divided by the number of documents $N_{doc}$.</p>
\begin{equation*}
DF = \frac{n_{doc}}{N_{doc}}
\end{equation*}<p><strong>Inverse Document Frequency (IDF)</strong></p>
<p>The inverse document frequency is the inverse of DF.</p>
\begin{equation*}
IDF = \frac{N_{doc}}{n_{doc}}
\end{equation*}<p>Practically, to avoid the explosion of IDF and dividing by zero, IDF can be computed by log format with adding 1 to denominator as below.</p>
\begin{equation*}
IDF = log(\frac{N_{doc}}{n_{doc}+1})
\end{equation*}<p><strong>Reference</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">Wikipedia - tf-idf</a></li>
<li><a href="https://towardsdatascience.com/tf-idf-for-document-ranking-from-scratch-in-python-on-real-world-dataset-796d339a4089">Towards Data Science - TF-IDF from scratch in python on real world dataset.</a></li>
<li><a href="https://stevenloria.com/tf-idf/">Stevenloria.com - Tutorial: Finding Important Words in Text Using TF-IDF</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/term-frequency-inverse-document-frequency/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-document">Create a document<a class="anchor-link" href="../../posts/term-frequency-inverse-document-frequency/#Create-a-document">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'this is a sample.'</span><span class="p">,</span> 
            <span class="s1">'this is another example. "this" also appears in the second example.'</span><span class="p">]</span>

<span class="n">documents</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>['this is a sample.',
 'this is another example. "this" also appears in the second example.']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Apply-TF-IDF-vectorizer">Apply TF-IDF vectorizer<a class="anchor-link" href="../../posts/term-frequency-inverse-document-frequency/#Apply-TF-IDF-vectorizer">¶</a>
</h2>
<p>Now applying TF-IDF to each sentence, we will obtain the feature vector for each document accordingly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
<span class="n">df_tfidf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">df_tfidf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>also</th>
      <th>another</th>
      <th>appears</th>
      <th>example</th>
      <th>in</th>
      <th>is</th>
      <th>sample</th>
      <th>second</th>
      <th>the</th>
      <th>this</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.501549</td>
      <td>0.704909</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.501549</td>
    </tr>
<tr>
<th>1</th>
      <td>0.28249</td>
      <td>0.28249</td>
      <td>0.28249</td>
      <td>0.56498</td>
      <td>0.28249</td>
      <td>0.200994</td>
      <td>0.000000</td>
      <td>0.28249</td>
      <td>0.28249</td>
      <td>0.401988</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The highest TF-IDF for each document</span>
<span class="n">df_tfidf</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     sample
1    example
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TF-IDF is zero if the word does not appear in a document</span>
<span class="n">df_tfidf</span><span class="o">==</span><span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[39]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>also</th>
      <th>another</th>
      <th>appears</th>
      <th>example</th>
      <th>in</th>
      <th>is</th>
      <th>sample</th>
      <th>second</th>
      <th>the</th>
      <th>this</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
<tr>
<th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/survival-analysis/" class="u-url">Survival Analysis</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/survival-analysis/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-25T23:30:44-07:00" itemprop="datePublished" title="May 25, 2019, 11:30:44 PM">May 25, 2019, 11:30:44 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/survival-analysis/#disqus_thread" data-disqus-identifier="cache/posts/survival-analysis.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/survival-analysis/#Goal">¶</a>
</h2>
<p>This post aims to introduce how to do survival analysis using <code>lifelines</code>. In this post, I use fellowship information in <a href="https://200wordsaday.com/">200 Words a day</a> to see what the survival curve looks like, which might be useful for users retention.</p>
<p><a href="https://200wordsaday.com/">200 Words a day</a> is the platform where those who wants to build a writing habit make a post with more than 200 words. There is a function to show how many consecutive days each user has been making a post as X-day streak.</p>
<p><img src="https://user-images.githubusercontent.com/8764683/58378449-d89c3700-7f48-11e9-9821-712fb4cdbcc3.png" alt="image"></p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://towardsdatascience.com/survival-analysis-in-python-a-model-for-customer-churn-e737c5242822">Towards Data Science in Medium - Survival Analysis to Explore Customer Churn in Python</a></li>
<li><a href="https://lifelines.readthedocs.io/en/latest/">lifelines</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="../../posts/survival-analysis/#Libraries">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lifelines</span> <span class="k">import</span> <span class="n">KaplanMeierFitter</span><span class="p">,</span> <span class="n">LogNormalFitter</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="more"><a href="../../posts/survival-analysis/">Read more… </a></p>
</div>
</div>
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-2.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="https-h1ros-github-io";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2019         <a href="mailto:data.h1ros@gmail.com">h1ros</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'h1ros-github-io/ama'
  };
</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(1, "YYYY-MM-DD");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- GitHub Buttons --><script async defer src="https://buttons.github.io/buttons.js"></script><!-- Twitter Widgets --><script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);
  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };
  return t;
}(document, "script", "twitter-wjs"));</script>
</body>
</html>
